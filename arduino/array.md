# Arduino 陣列實作與硬體控制範例

在 Arduino 微處理機實習中，陣列（Array）是管理多個硬體元件或複雜數據集合的關鍵工具。根據資料來源與我們討論的內容，以下將提供三個主要的陣列使用範例，涵蓋了硬體控制、資料儲存及輸出顯示。


## 利用一維陣列集中管理 GPIO 腳位（數位控制）

當您需要控制多個 LED 或執行器時，將它們連接的數位腳位（Pin Number）儲存到陣列中，可以讓程式碼更簡潔，並使用迴圈批次處理這些元件。

#### 應用目的：

批次設定和操作連接到 Arduino 數位腳位（例如 D10、D11、D12、D13）的四個 LED 燈。

#### 程式結構：

1. **宣告腳位陣列：** 使用 `int` 資料型態宣告一個陣列，儲存所有要控制的數位腳位編號。
2. **使用** **setup()** **設定模式：** 使用 `for` 迴圈迭代陣列，並呼叫 `pinMode()` 將所有腳位設定為輸出模式 (`OUTPUT`)。
3. **使用** **loop()** **執行操作：** 再次使用 `for` 迴圈迭代陣列，並呼叫 `digitalWrite()` 實現對每個 LED 的控制（例如依序點亮或閃爍）。

``` c
int pin[] = {10, 11, 12, 13};  // 宣告名為 pin 的整數陣列，儲存四個 LED 連接的腳位號碼。 
for(i=0; i<4; i++) {           // 使用 for 迴圈，從索引 0 跑到 3（共 4 個元素）。         
  pinMode(pin[i], OUTPUT);     // 將陣列中 pin[i] 所代表的腳位設定為輸出模式。           
  digitalWrite(pin[i], HIGH);  // 點亮陣列中 pin[i] 所代表的 LED。 
}
```

這種方式能夠在程式設計上避免重複撰寫相同的 `pinMode()` 和 `digitalWrite()` 程式碼，提高程式效率。


## 利用多維陣列儲存複雜控制序列（類比寫入 PWM）

多維陣列（例如二維陣列）常用於儲存需要依序執行的複雜數據集，例如控制多組 RGB LED 的亮度變化，或者在多工掃描（Multiplexing）中儲存不同時間點的輸出數據。

#### 應用目的：

在模擬燈光效果或控制馬達時，使用二維陣列來儲存多個腳位在不同時間點應輸出的數值，從而產生複雜的變化。

#### 程式結構：

1. **宣告 PWM 腳位陣列：** 儲存可以進行 PWM 輸出的腳位編號（在 Arduino Uno 板上通常有 6 支腳位，例如 D3, D5, D6, D9, D10, D11）。
2. **宣告二維亮度陣列：** 儲存不同階段（列）和不同腳位（行）的亮度值。
3. **使用巢狀迴圈：** 在 `loop()` 中使用巢狀 `for` 迴圈，外層控制序列或階段（例如 `i`），內層控制每個腳位（例如 `j`），並呼叫 `analogWrite()` 輸出數值。

``` c
const int pwm[] = {3, 5, 6, 9};          // 定義四個 PWM 輸出腳位。
int brightness[3][4] = { {1,2,3,4},{5,6,7,8},{6,7,8,9} };          // 假設定義了一個 3x4 的二維陣列 brightness 儲存多種亮度變化資料。 
for (int i = 0; i < 3; i++) {            // 外層迴圈：控制亮度變化的階段（例如 3 個階段）。
  for (int j = 0; j < 4; j++) {          // 內層迴圈：控制每個腳位。 
    analogWrite(pwm[j], brightness[i][j]); // 將brightness陣列中特定階段i、特定腳位j的亮度值輸出到 pwm[j] 腳位。
  }
}
```


## 利用常數陣列儲存查表數據（Display Look-up Table）

在控制如七段顯示器（Seven-Segment Display）這類需要特定位元模式來顯示字符的元件時，常數陣列（使用 `const` 修飾符）被用來儲存這些固定的字型碼，以實現**查表**功能。

#### 應用目的：

儲存數字 0 到 9 對應的七段顯示器（共陽極或共陰極）的 LED 點亮模式。

#### 程式結構：

1. **定義字型陣列：** 由於七段顯示器字型碼是固定且不可變的，因此使用 `const byte` 陣列儲存，通常將其儲存於 **Flash 記憶體** (`PROGMEM`) 中，以節省有限的 **SRAM** 空間。
2. **查表輸出：** 當需要顯示數字 N 時，直接存取 `font_code[N]` 即可獲得對應的位元組數值，並使用 `digitalWrite()` 或其他函式驅動顯示器。

``` c
// 假設共陰極，位元為 a, b, c, d, e, f, g 
const byte digit_code[] = { // 宣告一個常數位元組陣列。
 0b11111100,                // 數字 0 , 儲存數字 0 的位元模式。
 0b01100000,                // 數字 1 , 儲存數字 1 的位元模式。
 ...                        // 依序儲存數字 2 到 9 的位元模式。
};

byte output_val = digit_code[7]; // 當需要顯示數字 7 時，直接取出索引 7 的位元組數值。
```

七段顯示器多工掃描的原理即是依序掃描位數，並在掃描的總時間小於視覺暫留時間時，依序輸出這些儲存在陣列中的段資料 (`abcdefgp`) 和致能信號。

